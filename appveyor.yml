version: 2.0.0.{build}
branches:
  only:
  - dotnetcore
skip_tags: true
image: Visual Studio 2015
configuration: Release
platform: Any CPU
assembly_info:
  patch: true
  file: '**\AssemblyInfo.*'
  assembly_version: '{version}'
  assembly_file_version: '{version}'
  assembly_informational_version: '{version}'
install:
- cmd: set PATH=C:\Program Files (x86)\MSBuild\14.0\Bin;%PATH%
build:
  verbosity: minimal
after_build:
- cmd: >-
    dotnet pack src\Susanoo.Core --output artifacts

    dotnet pack src\Susanoo.Transforms --output artifacts

    dotnet pack src\Susanoo.Transforms.SqlServer --output artifacts

    dotnet pack src\Susanoo.DependencyInjection.AutoFac --output artifacts

    dotnet pack src\Susanoo.DependencyInjection.StructureMap --output artifacts
test_script:
- cmd: >-
    dotnet test test/Susanoo.Core.Tests

    dotnet test test/Susanoo.Transforms.Tests

    dotnet test test/Susanoo.Transforms.SqlServer.Tests
artifacts:
- path: src\artifacts\*.nupkg
  name: nupkgs